<section class="page">
  <h1 class="page-title">Analizador inteligente de imágenes</h1>
  <p class="page-subtitle">
    Sube una imagen y obtén etiquetas generadas por servicios de IA (Google Vision / Imagga).
  </p>

  <div class="panel-card card p-4 md:p-6">
    <ui-image-upload-panel (analyze)="onAnalyze($event)" (fileChanged)="onFileChanged()"></ui-image-upload-panel>

    @if (isLoading()) {
      <ui-loading text="Analizando imagen..." size="md" colorClass="text-cyan-400"></ui-loading>
    }

    @if (error()) {
      <div class="error">
        {{ error() }}
      </div>
    }
  </div>

  @if (tags().length > 0) {
    <div class="result-card card p-4 md:p-6">
      @let url = previewUrl();
      @if (url) {
        <div class="preview relative h-64 sm:h-72 md:h-80">
          <img
            [src]="url"
            alt="Imagen seleccionada"
            class="w-full h-full object-contain rounded-lg"
          />
        </div>
      }

      @if (tags().length > 0) {
        <div class="tags-section">
          <div class="tags-header">
            <h2>Etiquetas detectadas</h2>
            @if (provider()) {
              <span class="provider-pill pill">
                Proveedor: {{ provider() }}
              </span>
            }
          </div>

          <div class="flex flex-wrap gap-2" aria-label="Etiquetas detectadas">
            @for (tag of tags(); track tag.label) {
              <ui-tag [label]="tag.label" [confidence]="tag.confidence"></ui-tag>
            }
          </div>
        </div>
      }
    </div>
  }
</section>
